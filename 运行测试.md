# 运行 GraphKnowledgeBase 测试

## 快速开始

### 1. 修改 Neo4j 密码

编辑 `examples/graph_knowledge_example.py`，修改第 25 行：

```python
NEO4J_PASSWORD = "password"  # ⚠️ 修改为你的实际密码
```

### 2. 运行测试

```bash
cd /home/justin/opensource/agentscope
python examples/graph_knowledge_example.py
```

## 测试内容

脚本会依次运行3个示例：

### 示例 1: 基础向量检索（自动运行）
- 测试文档添加
- 测试向量相似度检索
- 不需要 LLM，只使用 embedding

### 示例 2: 实体和关系提取（可选）
- 提取实体（人名、组织、地点等）
- 提取实体间关系
- 测试 vector/graph/hybrid 检索模式

### 示例 3: 社区检测（可选）
- 运行 Neo4j GDS 算法
- 生成社区摘要
- 需要 Neo4j GDS 插件

## 配置说明

### API Key（已配置）
✅ DashScope API Key 已在脚本中设置：`sk-3ee953aac5fc4deeb57a0170112f0a00`

### Neo4j 连接
- URI: `bolt://localhost:7687`
- 用户名: `neo4j`
- 密码: `password` ⚠️ **需要修改**

## 预期输出

```
================================================================================
GraphKnowledgeBase Usage Examples
================================================================================

📌 配置信息:
   - Neo4j URI: bolt://localhost:7687
   - Neo4j User: neo4j
   - DashScope API Key: sk-3ee953aac5fc4d...

⚠️  请确保:
   1. Neo4j 正在运行
   2. 修改了脚本中的 NEO4J_PASSWORD

================================================================================
Example 1: Basic Vector-Only Mode (No Graph Features)
================================================================================

📥 Adding documents...
✅ Added 3 documents

🔍 Searching: 'Where does Alice work?'

📄 Found 2 results:
  ...
```

## 常见问题

### 连接失败

```bash
# 检查 Neo4j 是否运行
docker ps | grep neo4j

# 如果未运行，启动它
docker start neo4j
```

### 认证失败

修改脚本中的 `NEO4J_PASSWORD` 为你的实际密码。

### 社区检测失败

确保 Neo4j 安装了 GDS 插件：

```bash
docker run -d \
  --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/password \
  -e NEO4J_PLUGINS='["graph-data-science"]' \
  neo4j:latest
```

## 查看数据

访问 Neo4j Browser: http://localhost:7474

```cypher
// 查看文档
MATCH (d:Document_basic_knowledge) RETURN d LIMIT 10

// 查看实体
MATCH (e:Entity_graph_knowledge) RETURN e LIMIT 10

// 查看关系
MATCH (e1:Entity_graph_knowledge)-[r:RELATED_TO]->(e2)
RETURN e1.name, r.type, e2.name
LIMIT 10
```

## 清理数据

```cypher
// 在 Neo4j Browser 中执行
MATCH (n) DETACH DELETE n
```

